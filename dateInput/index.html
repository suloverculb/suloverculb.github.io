<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>出生年月日輸入元件</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .date-input-field {
            outline: none;
            transition: all 0.2s ease;
        }
        .date-input-field:focus {
            background-color: #3b82f6;
            color: white;
        }
        .date-input-field::placeholder {
            opacity: 0.5;
        }
        .date-input-field:focus::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
    <div class="w-full max-w-md">
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-xl font-semibold mb-4 text-gray-800">出生年月日</h2>
            
            <!-- 日期輸入容器 -->
            <div class="relative">
                <div class="flex items-center border-2 border-gray-300 rounded-lg px-4 py-3 focus-within:border-blue-500 transition-colors bg-white">
                    <!-- 年份標籤 -->
                    <span class="text-gray-500 text-sm mr-1">民國</span>
                    
                    <!-- 年份輸入 -->
                    <input 
                        type="text" 
                        id="year" 
                        class="date-input-field w-12 text-center px-1 py-1 rounded" 
                        maxlength="3"
                        placeholder="年"
                        inputmode="numeric"
                    />          
                    <!-- 分隔符 -->
                    <span class="text-gray-400 mx-1">-</span>
                    
                    <!-- 月份輸入 -->
                    <input 
                        type="text" 
                        id="month" 
                        class="date-input-field w-10 text-center px-1 py-1 rounded" 
                        maxlength="2"
                        placeholder="月"
                        inputmode="numeric"
                    />
                    
                    <!-- 分隔符 -->
                    <span class="text-gray-400 mx-1">-</span>
                    
                    <!-- 日期輸入 -->
                    <input 
                        type="text" 
                        id="day" 
                        class="date-input-field w-10 text-center px-1 py-1 rounded" 
                        maxlength="2"
                        placeholder="日"
                        inputmode="numeric"
                    />
                    
                    <!-- 日曆圖標 -->
                    <button type="button" class="ml-auto text-blue-500 hover:text-blue-700 transition-colors" id="calendarBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                        </svg>
                    </button>
                </div>
            </div>

            <!-- 顯示完整日期 -->
            <div class="mt-4 p-4 bg-gray-50 rounded-lg">
                <p class="text-sm text-gray-600 mb-1">當前輸入：</p>
                <p id="dateDisplay" class="text-lg font-medium text-gray-800">民國 ___ 年 __ 月 __ 日</p>
            </div>

            <!-- 示例說明 -->
            <div class="mt-4 text-sm text-gray-600 space-y-1">
                <p>• 年份：輸入3位數後自動跳至月份</p>
                <p>• 月份：輸入2位數後自動跳至日期</p>
                <p>• 焦點時會顯示藍色背景</p>
            </div>
        </div>
    </div>

    <script>
        // 獲取所有輸入欄位
        const yearInput = document.getElementById('year');
        const monthInput = document.getElementById('month');
        const dayInput = document.getElementById('day');
        const dateDisplay = document.getElementById('dateDisplay');
        const calendarBtn = document.getElementById('calendarBtn');

        // 只允許輸入數字
        function onlyNumbers(e) {
            const value = e.target.value;
            e.target.value = value.replace(/[^0-9]/g, '');
        }

        // 自動跳轉到下一個欄位
        function autoJump(currentInput, nextInput, maxLength) {
            if (currentInput.value.length >= maxLength) {
                nextInput.focus();
                nextInput.select();
            }
        }

        // 更新顯示的完整日期
        function updateDisplay() {
            const year = yearInput.value || '___';
            const month = monthInput.value || '__';
            const day = dayInput.value || '__';
            dateDisplay.textContent = `民國 ${year.padStart(3, '_')} 年 ${month.padStart(2, '_')} 月 ${day.padStart(2, '_')} 日`;
        }

        // 年份輸入事件
        yearInput.addEventListener('input', function(e) {
            onlyNumbers(e);
            autoJump(yearInput, monthInput, 3);
            updateDisplay();
        });

        // 月份輸入事件
        monthInput.addEventListener('input', function(e) {
            onlyNumbers(e);
            // 驗證月份範圍（1-12）
            if (e.target.value.length === 2) {
                const monthValue = parseInt(e.target.value);
                if (monthValue > 12) {
                    e.target.value = '12';
                } else if (monthValue < 1 && e.target.value !== '0') {
                    e.target.value = '01';
                }
            }
            autoJump(monthInput, dayInput, 2);
            updateDisplay();
        });

        // 日期輸入事件
        dayInput.addEventListener('input', function(e) {
            onlyNumbers(e);
            // 驗證日期範圍（1-31）
            if (e.target.value.length === 2) {
                const dayValue = parseInt(e.target.value);
                if (dayValue > 31) {
                    e.target.value = '31';
                } else if (dayValue < 1 && e.target.value !== '0') {
                    e.target.value = '01';
                }
            }
            updateDisplay();
        });

        // 自動補0的函數
        function padWithZero(input, maxLength) {
            if (input.value && input.value.length > 0 && input.value.length < maxLength) {
                input.value = input.value.padStart(maxLength, '0');
                updateDisplay();
            }
        }

        // 年份失去焦點時自動補0
        yearInput.addEventListener('blur', function() {
            padWithZero(yearInput, 3);
        });

        // 月份失去焦點時自動補0
        monthInput.addEventListener('blur', function() {
            padWithZero(monthInput, 2);
        });

        // 日期失去焦點時自動補0
        dayInput.addEventListener('blur', function() {
            padWithZero(dayInput, 2);
        });

        // 點擊欄位時選中所有文字
        [yearInput, monthInput, dayInput].forEach(input => {
            input.addEventListener('focus', function() {
                this.select();
            });
            
            input.addEventListener('click', function() {
                this.select();
            });
        });

        // 鍵盤支援：使用左右箭頭切換欄位
        yearInput.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowRight' || e.key === 'Tab') {
                if (this.selectionStart === this.value.length) {
                    e.preventDefault();
                    monthInput.focus();
                    monthInput.select();
                }
            }
        });

        monthInput.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowRight') {
                if (this.selectionStart === this.value.length) {
                    e.preventDefault();
                    dayInput.focus();
                    dayInput.select();
                }
            } else if (e.key === 'ArrowLeft') {
                if (this.selectionStart === 0) {
                    e.preventDefault();
                    yearInput.focus();
                    yearInput.select();
                }
            }
        });

        dayInput.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                if (this.selectionStart === 0) {
                    e.preventDefault();
                    monthInput.focus();
                    monthInput.select();
                }
            }
        });

        // 日曆按鈕點擊事件（可以擴展實際功能）
        calendarBtn.addEventListener('click', function() {
            alert('日曆功能可以在這裡實作！\n當前日期：' + dateDisplay.textContent);
        });

        // 初始化顯示
        updateDisplay();
    </script>
</body>
</html>